<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Undangan Pernikahan</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- Musik -->
  <audio id="bgMusic" loop>
    <source src="asset/jamrud.mp3" type="audio/mpeg" />
  </audio>
  <button id="musicBtn">ðŸ”Š</button>

  <!-- Halaman Cover -->
  <div id="coverPage" class="container section-1 fade-in">
    <h2>Kepada Yth:</h2>
    <h1 id="guestName">Tamu Undangan</h1>
    <button onclick="openInvitation()">Buka Undangan</button>
  </div>

  <!-- Isi Undangan -->
  <div id="sectionsWrapper" style="display: none;">
    <div class="container section-2 fade-section active">
      <h2>Detail Acara</h2>
      <p>Sabtu, 12 Juli 2025<br>Gedung Serbaguna Harmoni</p>
      <div id="sessionInfo"></div>
    </div>
    <div class="container section-3 fade-section">
      <h2>Penutup</h2>
      <p>Merupakan suatu kehormatan bagi kami apabila Bapak/Ibu/Saudara/i berkenan hadir.</p>
    </div>
  </div>

  <script>
    function getParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    const guestName = getParam("to");
    const session = getParam("session");

    document.getElementById("guestName").textContent = guestName
      ? decodeURIComponent(guestName.replace(/\+/g, " "))
      : "Tamu Undangan";

    const bgMusic = document.getElementById("bgMusic");
    const musicBtn = document.getElementById("musicBtn");
    let isPlaying = false;

    function toggleMusic() {
      if (isPlaying) {
        bgMusic.pause();
        musicBtn.textContent = "ðŸ”‡";
      } else {
        bgMusic.play().catch(() => {});
        musicBtn.textContent = "ðŸ”Š";
      }
      isPlaying = !isPlaying;
    }

    musicBtn.addEventListener("click", toggleMusic);

    document.body.addEventListener("click", () => {
      if (!isPlaying) {
        bgMusic.play().catch(() => {});
        isPlaying = true;
        musicBtn.textContent = "ðŸ”Š";
      }
    }, { once: true });

    function openInvitation() {
      const cover = document.getElementById("coverPage");
      const wrapper = document.getElementById("sectionsWrapper");

      bgMusic.play().catch(() => {});
      isPlaying = true;
      musicBtn.textContent = "ðŸ”Š";

      cover.classList.remove("fade-in");
      cover.classList.add("fade-out");

      setTimeout(() => {
        cover.style.display = "none";
        wrapper.style.display = "block";
        wrapper.classList.add("fade-in");

        const sessionInfo = document.getElementById("sessionInfo");
        if (session === "1") {
          sessionInfo.innerHTML = "<p><b>Sesi 1</b><br>12:00 â€“ 13:00</p>";
        } else if (session === "2") {
          sessionInfo.innerHTML = "<p><b>Sesi 2</b><br>13:00 â€“ 14:00</p>";
        } else {
          sessionInfo.innerHTML = "<p><i>Sesi belum ditentukan.</i></p>";
        }
      }, 500);
    }

    const sections = document.querySelectorAll(".fade-section");
    let currentSection = 0;

    function showSection(index) {
      if (index >= 0 && index < sections.length) {
        sections[currentSection].classList.remove("active");
        currentSection = index;
        sections[currentSection].classList.add("active");
      }
    }

    function nextSection() { showSection(currentSection + 1); }
    function prevSection() { showSection(currentSection - 1); }

    let touchStartY = 0;
    document.addEventListener("touchstart", e => {
      if (document.getElementById("sectionsWrapper").style.display !== "block") return;
      touchStartY = e.changedTouches[0].screenY;
    });
    document.addEventListener("touchend", e => {
      if (document.getElementById("sectionsWrapper").style.display !== "block") return;
      const touchEndY = e.changedTouches[0].screenY;
      if (touchEndY < touchStartY - 50) nextSection();
      else if (touchEndY > touchStartY + 50) prevSection();
    });

    let isScrolling = false;
    document.addEventListener("wheel", (e) => {
      if (document.getElementById("sectionsWrapper").style.display !== "block") return;
      if (isScrolling) return;
      isScrolling = true;
      if (e.deltaY > 0) nextSection();
      else prevSection();
      setTimeout(() => isScrolling = false, 1000);
    });
  </script>
</body>
</html>
